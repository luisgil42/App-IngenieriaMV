{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Verificación de dos factores - MV Ingeniería</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0; padding: 0;
      font-family: 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: radial-gradient(circle at top, rgba(15,23,42,0.35) 0, transparent 55%),
                  linear-gradient(180deg,#052e26,#0b2a4a);
      min-height: 100vh;
      display:flex; align-items:center; justify-content:center;
      color:#111827;
    }
    .card {
      background:#fff;
      width:100%; max-width:420px;
      padding:2.2rem 2rem 1.8rem;
      border-radius:22px;
      box-shadow: 0 18px 45px rgba(15,23,42,0.55), 0 0 0 1px rgba(15,23,42,0.06);
      text-align:center;
      position:relative;
      overflow:hidden;
    }
    .card::before, .card::after {
      content:"";
      position:absolute;
      width:140px; height:140px;
      border-radius:50%;
      filter: blur(18px);
      opacity: .35;
      z-index: -1;
    }
    .card::before { background:#38bdf8; top:-60px; left:-60px; }
    .card::after  { background:#22c55e; bottom:-60px; right:-60px; }

    .logo-box{
      display:inline-block;
      padding: 8px 10px;
      background: rgba(255,255,255,0.95);
      border-radius: 12px;
      border: 2px solid rgba(56,189,248,0.45);
      box-shadow: 0 6px 14px rgba(15,23,42,0.18);
      margin-bottom: .75rem;
    }
    .logo-box img{ max-width:165px; height:auto; display:block; }

    h1{ margin:0; font-size:1.4rem; font-weight:800; color:#111827; }
    .subtitle{ margin-top:.15rem; font-size:.9rem; color:#6b7280; }

    .info-banner{
      margin:1rem 0 1.2rem;
      padding:.7rem .9rem;
      border-radius:.75rem;
      background:#eff6ff;
      color:#1d4ed8;
      font-size:.85rem;
      text-align:left;
    }

    .greeting{
      font-size:.92rem;
      margin-bottom:1.2rem;
      color:#374151;
      text-align:left;
    }
    .greeting strong{ font-weight:700; color:#111827; }

    form{ text-align:left; }
    label{
      display:block;
      font-size:.85rem;
      font-weight:600;
      color:#374151;
      margin-bottom:.35rem;
    }

    input[type="text"]{
      width:100%;
      padding:.75rem .8rem;
      border-radius:.75rem;
      border:2px solid #d1d5db;
      font-size:1rem;
      letter-spacing:.22em;
      text-align:center;
      font-weight:600;
      color:#111827;
      transition: border-color .15s, box-shadow .15s;
    }
    input[type="text"]:focus{
      outline:none;
      border-color:#2563eb;
      box-shadow:0 0 0 1px rgba(37,99,235,0.35);
    }

    .hint{
      margin-top:.35rem;
      font-size:.78rem;
      color:#6b7280;
    }

    .remember-row{
      display:flex;
      align-items:center;
      gap:.45rem;
      margin-top:1rem;
      font-size:.85rem;
      color:#374151;
    }
    .remember-row input{ width:1rem; height:1rem; }

    button[type="submit"]{
      margin-top:1.4rem;
      width:100%;
      padding:.8rem;
      border-radius:999px;
      border:none;
      background: linear-gradient(90deg,#1d4ed8,#2563eb);
      color:#fff;
      font-weight:700;
      font-size:.98rem;
      cursor:pointer;
      box-shadow:0 10px 22px rgba(37,99,235,0.45);
      transition: transform .1s ease, box-shadow .1s ease, filter .12s ease;
    }
    button:hover{
      filter: brightness(1.06);
      transform: translateY(-1px);
      box-shadow:0 14px 26px rgba(37,99,235,0.5);
    }
    button:active{
      transform: translateY(0);
      box-shadow:0 5px 12px rgba(30,64,175,0.45);
    }

    .messages{ margin-bottom:.7rem; }
    .msg{
      padding:.5rem .7rem;
      border-radius:.6rem;
      font-size:.8rem;
      margin-bottom:.4rem;
    }
    .msg.error{ background:#fee2e2; color:#b91c1c; }
    .msg.success{ background:#ecfdf3; color:#166534; }
    .msg.info{ background:#eff6ff; color:#1d4ed8; }

    .footer{
      margin-top:1.4rem;
      font-size:.72rem;
      color:#9ca3af;
      text-align:center;
    }
  </style>
</head>
<body>

  <div class="card">
    <div class="logo-box">
      <img src="{% static 'core/images/logo_mv.png' %}" alt="MV Ingeniería">
    </div>

    <h1>Verificación de dos factores</h1>
    <div class="subtitle">MV Ingeniería</div>

    {% if messages %}
      <div class="messages">
        {% for message in messages %}
          <div class="msg {{ message.tags }}">{{ message }}</div>
        {% endfor %}
      </div>
    {% endif %}

    <div class="info-banner">
      <strong>Por seguridad</strong>, debes introducir el código de tu aplicación de autenticación.
    </div>

    <p class="greeting">
      Hola <strong>{{ user.get_full_name|default:user.username }}</strong>.
      Ingresa el código para continuar.
    </p>

    <form method="post">
      {% csrf_token %}

      <label for="id_token">Código de verificación</label>
      <input
        type="text"
        id="id_token"
        name="token"
        inputmode="numeric"
        autocomplete="one-time-code"
        placeholder="123 456"
        maxlength="10"
        required
      >
      <div class="hint">
        Es el código de 6 dígitos que ves en tu app (Google/Microsoft Authenticator).
      </div>

      <div class="remember-row">
        <input type="checkbox" id="id_remember_device" name="remember_device">
        <label for="id_remember_device" style="margin:0;">
          Recordar este dispositivo durante 90 días
        </label>
      </div>

      <button type="submit">Verificar y continuar</button>
    </form>

    <div class="footer">MV Ingeniería — Seguridad de cuenta</div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const el = document.getElementById("id_token");
      if (el) el.focus();
    });
  </script>
</body>
</html>